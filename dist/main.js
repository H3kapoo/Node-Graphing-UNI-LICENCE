/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={443:(t,e,n)=>{"use strict";t.exports=n.p+"73fb7b7f0e68b372adfe.ttf"},646:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var i=n(645),s=n.n(i),r=n(667),o=n.n(r),a=new URL(n(443),n.b),l=new URL(n(433),n.b),c=s()((function(t){return t[1]})),h=o()(a),d=o()(l);c.push([t.id,'@font-face {\n    font-family: "mainFont";\n    src: url('+h+');\n}\n\n*{\n    font-family: "mainFont";\n    padding: 0;\n    margin: 0;\n    box-sizing:border-box;\n}\n:root {\n    --main-dark: #15191E;\n  }\n\n*::-webkit-scrollbar {\n    width: 0em;\n  }\n   \n#appCont{\n    \n    position:fixed;\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n    height: 100%;\n    background: var(--main-dark);\n}\n\n#spann{\n    color:red;\n}\n\n#canvas-cont{\n    width: 100%;\n    height: calc(100% - 36px); /*because of tabs height*/\n    overflow: auto;\n    /* background-color: rgb(75, 75, 75); */\n    background-color: #E0E2EB;\n\n}\n#canvas{\n    overflow-x: auto;\n    display: block;\n    /* background-color: rgb(212, 90, 90); */\n}\n\n\n#cli-cont{\n    width: 100%;\n    height: 100%;   \n    padding-top: 5px;\n    background-color: var(--main-dark);\n}\n\n#cli-textarea2{\n    white-space: pre;\n    font-size: 14px;\n    line-height: em;\n    font-size: 1em;\n    white-space: nowrap;\n    overflow-x: auto;\n    resize: none;\n    width: 100%;\n    height: 100%; \n    -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */\n    -moz-box-sizing: border-box;    /* Firefox, other Gecko */\n    box-sizing: border-box;         /* Opera/IE 8+ */\n    padding: 5px;\n}\n\n.highLite{\n    width: 100%;\n    height: 100%;\n    /* display: flex;    \n    flex-direction: row; */\n    position: relative;\n    /* white-space: nowrap; */\n    /* overflow-x: auto;\n    overflow-y: auto; */\n  }\n  \n\n.highLite_editable{\n    width: 100%;\n    height: 100%;\n    outline: none;\n  }\n  \n  /* THE UNDERLAYING ONE WITH COLORS */\n.highLite_colors {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0; \n    user-select: none;\n  }\n\n.highLite_colors_err{\n    padding-top: 20px;\n}\n  \n  /* THE OVERLAYING CONTENTEDITABLE WITH TRANSPARENT TEXT */\n  highLite_editable {\n    position: relative;\n    -webkit-text-fill-color: transparent; /* Chrome: make text transparent */\n    /* text-fill-color: trasparent;         One day, hopefully? */\n    color: black;                         /* But keep caret black */\n  }\n\n.hl_angled{ color: turquoise; }\n.hl_curly{ color: fuchsia; }\n\n.highlight {\n    background-color: yellow;\n  }\n\n.gutter {\n    background-repeat: no-repeat;\n    background-position: 50%;\n    background-color: rgb(128, 128, 128);\n}\n\n.gutter.gutter-horizontal {\n    background-image: url('+d+");\n    cursor: col-resize;\n}\n\n.gutter.gutter-vertical {\n    background-image: url("+d+');\n    cursor:row-resize;\n}\n\n.cli_tab_tag{\n    outline: none;\n    padding-top: 5px;\n}\n#cmd-prepender{\n    padding-left: 5px;\n}\n\n#cmd-text{\n    word-break: break-all;\n    white-space: pre-wrap;\n}\n#cmd-info-text-prep{\n    padding-right: 5px;\n    color: #A8ED2E;\n}\n\n#cmd-err-text-prep{\n    padding-right: 5px;\n    color: #ED572E;\n}\n#cmd-info-text{\n    word-break: break-all;\n    white-space: pre-wrap;\n    color: #E0E2EB;\n}\n#cmd-err-text{\n    word-break: break-all;\n    white-space: pre-wrap;\n    color: #E0E2EB;\n}\n\n#cmd-text-number{\n    word-break: break-all;\n    white-space: pre-wrap;\n    color: #2EB2ED;\n}\n\n\n/* .highLite_colors {\n    width: 100%;\n    height: 100%;\n    outline: none; \n    padding-top: 5px;\n    word-wrap: break-word;\n    white-space: pre-wrap;\n    word-break: break-word;\n    color:#E0E2EB;\n} */\n\n.highLite_editable { \n    padding-left: 5px;\n    align-items: center;\n    word-wrap: break-word;\n    white-space: pre-wrap;\n    word-break: break-word;\n    color: #E0E2EB;\n}\n\n/* .highLite_editable::before{\n    content: "CLI >";\n    padding-left: 3px;\n    padding-right: 10px;\n    background-color: #5F9B6D;\n    border-radius: 0px;\n} */\n\n\n/* .highLite_editable::before{\n    content: "CLI>";\n    padding-left: 3px;\n    padding-right: 10px;\n    background-color: turquoise;\n    border-radius: 10px;\n} */\n',""]);const p=c},330:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(645),s=n.n(i)()((function(t){return t[1]}));s.push([t.id,'/*!\n * tabbyjs v12.0.3\n * Lightweight, accessible vanilla JS toggle tabs.\n * (c) 2019 Chris Ferdinandi\n * MIT License\n * http://github.com/cferdinandi/tabby\n */\n\n :root {\n  --main-dark: #15191E;\n}\n\n/**\n * The tablist\n */\n[role="tablist"] {\n  border-bottom: 1px solid #11141b;\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n[role="tablist"] * {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/**\n * The tablist item\n */\n@media (min-width: 30em) {\n  [role="tablist"] li {\n    display: inline-block;\n  }\n}\n\n/**\n * The tabs\n */\n[role="tab"] {\n  border: 1px solid transparent;\n  border-top-color: lightgray;\n  display: block;\n  padding: 0.4em 1em;\n  text-decoration: none;\n  font-size: 1em;\n  color: black;\n  /**\n\t * Active tab styling\n\t */\n  /**\n\t * Tabs on hover\n\t */\n}\n\n@media (min-width: 30em) {\n  [role="tab"] {\n    border-top-color: transparent;\n    border-top-left-radius: 0.0em;\n    border-top-right-radius: 0.0em;\n    display: inline-block;\n    margin-bottom: -1px;\n  }\n}\n\n[role="tab"][aria-selected="true"] {\n  background-color: lightgray;\n}\n\n@media (min-width: 30em) {\n  [role="tab"][aria-selected="true"] {\n    background-color: transparent;\n    border: 1px solid lightgray;\n    border-bottom-color:  var(--main-dark);\n  }\n}\n\n[role="tab"]:hover:not([aria-selected="true"]) {\n  background-color: #f7f7f7;\n}\n\n@media (min-width: 30em) {\n  [role="tab"]:hover:not([aria-selected="true"]) {\n    border: 1px solid lightgray;\n    border-bottom-color:  var(--main-dark);\n  }\n}\n\n/**\n * [hidden] fallback for IE10 and lower\n */\n[hidden] {\n  display: none;\n}\n\n#tabby-toggle_cli-cont{\n  color: #E0E2EB;\n  background-color:  var(--main-dark);\n  outline: none;\n}\n#tabby-toggle_cli-error{\n  color: #E0E2EB;\n  background-color:  var(--main-dark);\n  outline: none;\n}\n\n#tabby-toggle_canvas-cont{\n  color: #E0E2EB;\n  background-color:  var(--main-dark);\n  outline: none;\n}\n',""]);const r=s},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,i){"string"==typeof t&&(t=[[null,t,""]]);var s={};if(i)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(s[o]=!0)}for(var a=0;a<t.length;a++){var l=[].concat(t[a]);i&&s[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],h=r[c]||0,d="".concat(c," ").concat(h);r[c]=h+1;var p=n(d),u={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(e[p].references++,e[p].updater(u)):e.push({identifier:d,updater:s(u,i),references:1}),o.push(d)}return o}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var r=i(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=n(r[o]);e[a].references--}for(var l=i(t,s),c=0;c<r.length;c++){var h=n(r[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}r=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i=n.css,s=n.media,r=n.sourceMap;s?t.setAttribute("media",s):t.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},394:function(t,e,n){var i,s;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),s=void 0!==n.g?n.g:"undefined"!=typeof window?window:this,void 0===(i=function(){return function(t){"use strict";var e={idPrefix:"tabby-toggle_",default:"[data-tabby-default]"},n=function(e){if(e&&"true"!=e.getAttribute("aria-selected")){var n=document.querySelector(e.hash);if(n){var i=function(t){var e=t.closest('[role="tablist"]');if(!e)return{};var n=e.querySelector('[role="tab"][aria-selected="true"]');if(!n)return{};var i=document.querySelector(n.hash);return n.setAttribute("aria-selected","false"),n.setAttribute("tabindex","-1"),i?(i.setAttribute("hidden","hidden"),{previousTab:n,previousContent:i}):{previousTab:n}}(e);!function(t,e){t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0"),e.removeAttribute("hidden"),t.focus()}(e,n),i.tab=e,i.content=n,function(e,n){var i;"function"==typeof t.CustomEvent?i=new CustomEvent("tabby",{bubbles:!0,cancelable:!0,detail:n}):(i=document.createEvent("CustomEvent")).initCustomEvent("tabby",!0,!0,n),e.dispatchEvent(i)}(e,i)}}};return function(i,s){var r,o,a={destroy:function(){var t=o.querySelectorAll("a");Array.prototype.forEach.call(t,(function(t){var e=document.querySelector(t.hash);e&&function(t,e,n){t.id.slice(0,n.idPrefix.length)===n.idPrefix&&(t.id=""),t.removeAttribute("role"),t.removeAttribute("aria-controls"),t.removeAttribute("aria-selected"),t.removeAttribute("tabindex"),t.closest("li").removeAttribute("role"),e.removeAttribute("role"),e.removeAttribute("aria-labelledby"),e.removeAttribute("hidden")}(t,e,r)})),o.removeAttribute("role"),document.documentElement.removeEventListener("click",l,!0),o.removeEventListener("keydown",c,!0),r=null,o=null},setup:function(){if(o=document.querySelector(i)){var t=o.querySelectorAll("a");o.setAttribute("role","tablist"),Array.prototype.forEach.call(t,(function(t){var e=document.querySelector(t.hash);e&&function(t,e,n){t.id||(t.id=n.idPrefix+e.id),t.setAttribute("role","tab"),t.setAttribute("aria-controls",e.id),t.closest("li").setAttribute("role","presentation"),e.setAttribute("role","tabpanel"),e.setAttribute("aria-labelledby",t.id),t.matches(n.default)?t.setAttribute("aria-selected","true"):(t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1"),e.setAttribute("hidden","hidden"))}(t,e,r)}))}},toggle:function(t){var e=t;"string"==typeof t&&(e=document.querySelector(i+' [role="tab"][href*="'+t+'"]')),n(e)}},l=function(t){var e=t.target.closest(i+' [role="tab"]');e&&(t.preventDefault(),n(e))},c=function(t){var e=document.activeElement;e.matches(i+' [role="tab"]')&&(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Up","Down","Left","Right","Home","End"].indexOf(t.key)<0||function(t,e){var i=function(t){var e=t.closest('[role="tablist"]'),n=e?e.querySelectorAll('[role="tab"]'):null;if(n)return{tabs:n,index:Array.prototype.indexOf.call(n,t)}}(t);if(i){var s,r=i.tabs.length-1;["ArrowUp","ArrowLeft","Up","Left"].indexOf(e)>-1?s=i.index<1?r:i.index-1:["ArrowDown","ArrowRight","Down","Right"].indexOf(e)>-1?s=i.index===r?0:i.index+1:"Home"===e?s=0:"End"===e&&(s=r),n(i.tabs[s])}}(e,t.key))};return r=function(){var t={};return Array.prototype.forEach.call(arguments,(function(e){for(var n in e){if(!e.hasOwnProperty(n))return;t[n]=e[n]}})),t}(e,s||{}),a.setup(),function(e){if(!(t.location.hash.length<1)){var i=document.querySelector(e+' [role="tab"][href*="'+t.location.hash+'"]');n(i)}}(i),document.documentElement.addEventListener("click",l,!0),o.addEventListener("keydown",c,!0),a}}(s)}.apply(e,[]))||(t.exports=i)},433:t=>{"use strict";t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg=="}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={id:i,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,(()=>{"use strict";var t=n(379),e=n.n(t),i=n(795),s=n.n(i),r=n(569),o=n.n(r),a=n(565),l=n.n(a),c=n(216),h=n.n(c),d=n(589),p=n.n(d),u=n(646),g={};g.styleTagTransform=p(),g.setAttributes=l(),g.insert=o().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),e()(u.Z,g),u.Z&&u.Z.locals&&u.Z.locals;var m=n(330),f={};f.styleTagTransform=p(),f.setAttributes=l(),f.insert=o().bind(null,"head"),f.domAPI=s(),f.insertStyleElement=h(),e()(m.Z,f),m.Z&&m.Z.locals&&m.Z.locals;var v=n(394),b=n.n(v),y="undefined"!=typeof window?window:null,x=null===y,w=x?void 0:y.document,_="horizontal",A=function(){return!1},E=x?"calc":["","-webkit-","-moz-","-o-"].filter((function(t){var e=w.createElement("div");return e.style.cssText="width:"+t+"calc(9px)",!!e.style.length})).shift()+"calc",S=function(t){return"string"==typeof t||t instanceof String},L=function(t){if(S(t)){var e=w.querySelector(t);if(!e)throw new Error("Selector "+t+" did not match a DOM element");return e}return t},C=function(t,e,n){var i=t[e];return void 0!==i?i:n},O=function(t,e,n,i){if(e){if("end"===i)return 0;if("center"===i)return t/2}else if(n){if("start"===i)return 0;if("center"===i)return t/2}return t},I=function(t,e){var n=w.createElement("div");return n.className="gutter gutter-"+e,n},P=function(t,e,n){var i={};return S(e)?i[t]=e:i[t]=E+"("+e+"% - "+n+"px)",i},T=function(t,e){var n;return(n={})[t]=e+"px",n};const D=t=>Math.max(t.offsetHeight,t.scrollHeight);class M{_canvasObject_=void 0;constructor(t){this._canvasObject_=t,window.api.receive("nodify-export-image",((t,e)=>this.export(t)))}export(t){let e=this._canvasObject_.toDataURL("image/png").replace(/^data:image\/png;base64,/,"");t.sender.send("nodify-export-image",{base64Data:e})}}const k={radius:{active:!0,type:"integer"},pos:{active:!0,type:"intPairVec"},color:{active:!0,type:"string"},node_id:{active:!0,type:"integer"},type:{active:!0,type:"string"},id:{active:!0,type:"integer"},shouldWaitForAnim:{active:!0,type:"boolean"},duration:{active:!0,type:"integer"},others:{active:!1,type:"?"}},N={color:{active:!0,type:"string"},id:{active:!0,type:"integer"},conn_id:{active:!0,type:"integer"},id_src:{active:!0,type:"integer"},id_dest:{active:!0,type:"integer"},color:{active:!0,type:"string"},directed:{active:!0,type:"boolean"},elev:{active:!0,type:"integer"}},R={boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,integer:t=>!isNaN(t)&&!isNaN(parseInt(t)),intPairVec:t=>2===t.length&&!(isNaN(t[0])||isNaN(parseInt(t[0]))||isNaN(t[1])||isNaN(parseInt(t[1])))};class j{#animData=void 0;#animAux=void 0;#renderTriggerTime=16;#durationDone=0;#totalDuration=void 0;#animationDone=!1;#notified=!1;#t=0;constructor(){}nextAnimationState(t){1!==this.#t||this.#notified||(console.log("[OA] Anim done"),this.#animationDone=!0,delete t.anim,this.#notified=!0),this.#transition(t),this.#durationDone+=this.#renderTriggerTime,this.#t=this.#durationDone/this.#totalDuration,this.#t>=1&&(this.#t=1,this.#transition(t))}#transition(t){void 0===this.#animAux&&(this.#animAux={...t});for(const[e,n]of Object.entries(this.#animData))this.isTransitionable(e)&&(t[e]=this[`_${e}Transitioner`](this.#animAux[e],n))}_posTransitioner(t,e){return[(1-this.#t)*t[0]+this.#t*e[0],(1-this.#t)*t[1]+this.#t*e[1]]}isTransitionable(t){return"pos"===t}isAnimationDone(){return this.#animationDone}setUpAnim(t){this.#totalDuration=t.dt,this.#animData=void 0,this.#animationDone=!1,this.#notified=!1,this.#animData=t}}class z{#currentState={};#objAnimator=void 0;constructor(t){this.#currentState=t,this.#objAnimator=new j,t.anim&&this.#objAnimator.setUpAnim(this.#currentState.anim)}updateAnimations(){this.#objAnimator.nextAnimationState(this.#currentState)}isAnimationDone(){return this.#objAnimator.isAnimationDone()}hasAnimation(){return!!this.#currentState.anim}getCurrentState(){return this.#currentState}}class ${#state={};#actionsQueue=[];#maxNodeId=-1;#maxConnId=-1;#animationManagerRef=void 0;constructor(){this.#state={nodes:{},conns:{}}}async pushCreateNode(t){const e=this._getNextId("node");return t.node_id=e,this.#state.nodes[e]=new z({...t}),await this.#animationManagerRef.pushAndWaitAnimIfNeeded(this.#state.nodes[e]),{type:"createNode",paramsNow:this.#state.nodes[e].getCurrentState(),paramsBefore:t}}pushCreateNode2(t){const e=this._getNextId("node");t.node_id=e,this.#actionsQueue.push({type:"createNode",opts:t,param:t}),t.anim.duration,t.notifyUp=t=>this.notify(t),this.#state.nodes[e]=new z(t),this.notify({mode:"once"})}pushUpdateNode(t){if(void 0===t.id)throw{stage:"[Process]",msg:"No Node Id provided for pushUpdate !"};this._validateUserProcessed("node",t);let e=this.#state.nodes[t.id];if(void 0===e)throw{stage:"[Process]",msg:`Node Id: ${t.id} has not been found!`};delete t.id;let n={node_id:e.node_id};for(const[i,s]of Object.entries(t))e[i]?e[i]!==s&&(n[i]=s):n[i]=s,e[i]=s;this.#actionsQueue.push({type:"updateNode",opts:e,param:n}),this.#state.nodes[e.node_id]=e}pushDeleteNode(t){let e=this.#state.nodes[t];if(void 0===e)throw{stage:"[Process]",msg:`Can't delete non-existent node Id: ${t}`};if(e.conn_refs)for(let t=0;t<e.conn_refs.length;t++){let n=e.conn_refs[t];this.pushDeleteConn(n)}this.#actionsQueue.push({type:"deleteNode",opts:t,param:{node_id:t}})}pushCreateConn(t){if(this._validateUserProcessed("conn",t),void 0===this.#state.nodes[t.id_src])throw{stage:"[Process]",msg:`Node Id ${t.id_src} doesn't exist`};if(void 0===this.#state.nodes[t.id_dest])throw{stage:"[Process]",msg:`Node Id ${t.id_dest} doesn't exist`};let e=this._getNextId("conn");t.conn_id=e,this.#state.nodes[t.id_src].conn_refs||(this.#state.nodes[t.id_src].conn_refs=[]),this.#state.nodes[t.id_dest].conn_refs||(this.#state.nodes[t.id_dest].conn_refs=[]),this.#state.nodes[t.id_src].conn_refs.push(e),this.#state.nodes[t.id_dest].conn_refs.push(e),this.#actionsQueue.push({type:"createConn",opts:t,param:t})}pushUpdateConn(t){this._validateUserProcessed("conn",t);let e=this.#state.conns[t.id];if(void 0===e)throw{stage:"[Process]",msg:`Conn Id: ${t.id} has no been found!`};delete t.id;let n={conn_id:e.conn_id};for(const[i,s]of Object.entries(t))e[i]?e[i]!==s&&(n[i]=s):n[i]=s,e[i]=s;return this.#actionsQueue.push({type:"updateConn",opts:e,param:n}),{hasError:!1}}pushDeleteConn(t){let e=this.#state.conns[t];if(void 0===e)throw{stage:"[Process]",msg:`Can't delete non existent conn id: ${t} .`};let n={};n.id_src=e.id_src,n.id_dest=e.id_dest,n.conn_id=t,n.validRefs_src=this._removeRefIdOnce(this.#state.nodes[e.id_src].conn_refs,t),n.validRefs_dest=this._removeRefIdOnce(this.#state.nodes[e.id_dest].conn_refs,t),this.#actionsQueue.push({type:"deleteConn",opts:n,param:{conn_id:t}})}getPushedLogs(){let t=this.#actionsQueue;return this.#actionsQueue=[],{msg:t}}clearActionsQueue(){this.#actionsQueue=[]}_validateUserProcessed(t,e){if(!Object.entries(e).length)throw{stage:"[Process]",msg:"Passed data payload is empty!"};delete e.cmdName;for(const[t,n]of Object.entries(e))void 0===n&&delete e[t];for(const[n,i]of Object.entries(e)){if("node"===t){if(!k[n]||!k[n].active)throw{stage:"[Process]",msg:`Option: '${n}' is not supported on nodes. Check supported node options first!`};let t=k[n].type;if(!R[t](i))throw{stage:"[Process]",msg:`Option: '${n}' is not of expected type or out of bounds assignment error.                                error.Check command logic definition for errors!`}}if("conn"===t){if(!N[n]||!N[n].active)throw{stage:"[Process]",msg:`Option: '${n}' is not supported on conns. Check supported conns operations first!`};let t=N[n].type;if(!R[t](i))throw{stage:"[Process]",msg:`Option: '${n}' is not of expected type or out of bounds assignment error.                                error.Check command logic definition for errors!`}}}}_getNextId(t){return"node"===t?++this.#maxNodeId:"conn"===t?++this.#maxConnId:"undefined type"}_removeRefIdOnce(t,e){let n=[...t],i=n.indexOf(e);return i>-1&&n.splice(i,1),n}setAnimationManagerRef(t){this.#animationManagerRef=t}getActionsQueue(){return this.#actionsQueue}getState(){return this.#state}getNodeData(){return{...this.#state.nodes}}getConnsData(){return{...this.#state.conns}}}let F={};const U={oneString(t){if(1===this.stringVec(t).length)return this.stringVec(t);throw{stage:"[Parse]",msg:"Schema type doesn't accept multiple string values! Only one!"}},onePositiveNumber(t){let e=this.positiveNumberVec(t);if(e)return e;if(1===e.length)return e;throw{stage:"[Parse]",msg:"Schema type doesn't accept multiple positive int values! Only one!"}},oneNumber(t){let e=this.numberVec(t);if(e)return e;if(1===e.length)return e;throw{stage:"[Parse]",msg:"Schema type doesn't accept multiple positive int values! Only one!"}},twoString(t){if(2===this.stringVec(t).length)return this.stringVec(t);throw{stage:"[Parse]",msg:`Argument type must be string pair but it's not in ${t} !`}},twoPositiveNumber(t){let e=this.positiveNumberVec(t);if(e)return e;if(2===e.length)return e;throw{stage:"[Parse]",msg:`Argument type must be positive int pair but it's not in ${t}`}},twoNumber(t){let e=this.numberVec(t);if(e)return e;if(2===e.length)return e;throw{stage:"[Parse]",msg:`Argument type must be int pair but it's not in ${t}`}},stringVec(t){let e=t.split(","),n=[];if(","===t[0]||","===t[t.length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg: ${t} !`};for(let t=0;t<e.length;t++)n.push(e[t]);return n},positiveNumberVec(t){let e=t.split(","),n=[];if(","===t[0]||","===t[t.length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg: ${t} !`};for(let i=0;i<e.length;i++){if(!this._isValidPositiveInt(e[i]))throw{stage:"[Parse]",msg:`${e[i]} must be a positive integer in: ${t} but it's not!`};n.push(parseFloat(e[i]))}return n},numberVec(t){let e=t.split(","),n=[];if(","===t[0]||","===t[t.length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg: ${t} !`};for(let i=0;i<e.length;i++){if(!this._isValidInt(e[i]))throw{stage:"[Parse]",msg:`${e[i]} must be an integer in: ${t} but it's not!`};n.push(parseFloat(e[i]))}return n},twoStringVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg ${e[t]} !`};let s=e[t].split(",");if(2!==s.length)throw{stage:"[Parse]",msg:`Argument must be string pair but its not: ${e[t]}`};i.push(s[0],s[1]),n.push(i)}return n},twoPositiveNumberVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg ${e[t]} !`};let s=e[t].split(",");if(2!==s.length)throw{stage:"[Parse]",msg:`Argument must be int pair but its not: ${e[t]}`};if(!this._isValidPositiveInt(s[0]))throw{stage:"[Parse]",msg:`${s[0]} must be a positive Int in: ${e[t]} but it's not!`};if(!this._isValidPositiveInt(s[1]))throw{stage:"[Parse]",msg:`${s[1]} must be a positive Int in: ${e[t]} but it's not!`};i.push(parseFloat(s[0]),parseFloat(s[1])),n.push(i)}return n},twoNumberVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg ${e[t]} !`};let s=e[t].split(",");if(2!==s.length)throw{stage:"[Parse]",msg:`Argument must be int pair but its not: ${e[t]}`};if(!this._isValidInt(s[0]))throw{stage:"[Parse]",msg:`${s[0]} must be an Int in: ${e[t]} but it's not!`};if(!this._isValidInt(s[1]))throw{stage:"[Parse]",msg:`${s[1]} must be an Int in: ${e[t]} but it's not!`};i.push(parseFloat(s[0]),parseFloat(s[1])),n.push(i)}return n},stringVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg ${e[t]} !`};let s=e[t].split(",");for(let t=0;t<s.length;t++)i.push(parseInt(s[t]));n.push(i)}return n},positiveNumberVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg ${e[t]} !`};let s=e[t].split(",");for(let t=0;t<s.length;t++){if(!this._isValidPositiveInt(s[t]))throw{stage:"[Parse]",msg:`${s} must be a positive Int in: ${s} but it's not!`};i.push(parseFloat(s[t]))}n.push(i)}return n},numberVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])throw{stage:"[Parse]",msg:`Trailing comma is invalid at arg ${e[t]} !`};let s=e[t].split(",");for(let t=0;t<s.length;t++){if(!this._isValidInt(s[t]))throw{stage:"[Parse]",msg:`${s} must be an Int in: ${s} but it's not!`};i.push(parseFloat(s[t]))}n.push(i)}return n},oneDimStringVec(t){let e=t.split(","),n=[];if(","===t[0]||","===t[t.length-1])return{hasError:!0,msg:"Trailing comma is invalid at arg: "+t};for(let t=0;t<e.length;t++)n.push(e[t]);return n},nDimIntVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])return{hasError:!0,msg:"Trailing comma is invalid at arg: "+e[t]};let s=e[t].split(",");for(let t=0;t<s.length;t++){if(!this._isValidInt(s[t]))return{hasError:!0,msg:s[t]+" must be an INT in: "+s+" but it's not"};i.push(parseInt(s[t]))}n.push(i)}return n},twoDimIntVecs(t){let e=t.split("|"),n=[];for(let t=0;t<e.length;t++){let i=[];if(","===e[t][0]||","===e[t][e[t].length-1])return{hasError:!0,msg:"Trailing comma is invalid at arg: "+e[t]};let s=e[t].split(",");if(2!==s.length)return{hasError:!0,msg:"Argument must be 2D pair but its not: "+e[t]};if(!this._isValidInt(s[0]))return{hasError:!0,msg:s[0]+" must be an INT in: "+e[t]+" but it's not"};if(!this._isValidInt(s[1]))return{hasError:!0,msg:s[1]+" must be an INT in: "+e[t]+" but it's not"};i.push(parseInt(s[0]),parseInt(s[1])),n.push(i)}return n},oneDimIntVec(t){let e=t.split(","),n=[];if(","===t[0]||","===t[t.length-1])return{hasError:!0,msg:"Trailing comma is invalid at arg: "+t};for(let i=0;i<e.length;i++){if(!this._isValidInt(e[i]))return{hasError:!0,msg:e[i]+" must be an INT in: "+t+" but it's not"};n.push(parseInt(e[i]))}return n},_isValidInt:t=>!isNaN(t)&&!isNaN(parseInt(t)),_isValidPositiveInt:t=>!isNaN(t)&&!isNaN(parseInt(t))&&parseInt(t)>=0};class V{parse(t){let e={};const n=t.replace(/\s+/g," ").split(" ").filter((t=>0!==t.length));if(!n.length)throw{stage:"[Parse]",emptyLine:!0,msg:"Empty line. Nothing to do!"};if(!F[n[0]])throw{stage:"[Parse]",msg:`Command '${n[0]}' doesn't exist!`};e.cmdName=n[0];for(let t=1;t<n.length;t+=2){let i=n[t],s=this._isArgThere(n,t+1)?n[t+1]:null;if(!F[n[0]][i])throw{stage:"[Parse]",msg:`There is no option '${i}' for command: ${n[0]} .`};if(null==s)throw{stage:"[Parse]",msg:`There is no argument for option: ${i} .`};if(!U[F[n[0]][i]])throw{stage:"[Parse]",msg:"There is no argument schema to parse this argument,check for misspelling in the command schema."};e[this._noDash(i)]=U[F[n[0]][i]](s)}for(let t of F[n[0]].mandatory)if(!e[this._noDash(t)])throw{stage:"[Parse]",msg:`Mandatory option: '${t}' not present!`};return e}_noDash(t){return t.substr(1)}_isArgThere(t,e){return null!==t[e]}}let H={call(t,e,n){if(this[t])return this[t](e,n);throw{stage:"[Process]",msg:`Can't call unexisting command: '${t}' inside command '${e.cmdName}'!`}}};class B{process(t,e){if(!H[e.cmdName])throw{stage:"[Process]",msg:`Command '${e.cmdName}' exists but has no logic defined.Did you forget to add it?`};return e.get=function(t){return this[t]?this[t]:[]},H[e.cmdName](e,t)}}function W(t,e,n=15){let i=it(t,e),s=Z(i),r=[0,0];r[0]=Math.cos(s-Math.PI)*n+t[0],r[1]=Math.sin(s-Math.PI)*n+t[1];let o=nt(i),a=[o[0],o[1],0],l=K(a,[0,0,1]);l=J(l,n),l=G(l,r);let c=K(a,[0,0,-1]);return c=J(c,n),c=G(c,r),{p1:t,p2:l,p3:c}}function Y(t,e,n,i,s){let r=tt(t,e),o=nt(it(e,t)),a=K([o[0],o[1],0],[0,0,1]);a=J(a,s),a[0]+=r[0],a[1]+=r[1];let l=it(a,t),c=it(a,e),h=Z(l),d=Z(c),p=[0,0],u=[0,0];return p[0]=Math.cos(h)*n+t[0],p[1]=Math.sin(h)*n+t[1],u[0]=Math.cos(d)*i+e[0],u[1]=Math.sin(d)*i+e[1],{lineStart:p,cpPos:a,lineEnd:u}}function q(t,e,n,i){let s=.5,r=e[0]+.25*(t[0]-e[0])+s*s*(n[0]-e[0]),o=e[1]+.25*(t[1]-e[1])+s*s*(n[1]-e[1]),a=tt(t,n),l=nt(it(n,t)),c="";c=K([l[0],l[1],0],i>=0?[0,0,1]:[0,0,-1]),c=J(c,i),c[0]+=a[0],c[1]+=a[1];let h=it(c,a);var d,p;return h=nt(h),p=i,h=[(d=h)[0]*p,d[1]*p],[r+h[0],o+h[1]]}function X(t,e,n){t.font="0.60em Courier New",t.strokeStyle="#00000011",t.fillStyle="#00000066",t.textAlign="center",t.textBaseline="middle",t.lineWidth=2,t.fillText(n,e[0],e[1]),t.strokeText(n,e[0],e[1])}function Q(t,e,n){t.strokeStyle="#00000011",t.lineWidth=1,t.beginPath(),t.moveTo(e[0],e[1]),t.lineTo(n[0],n[1]),t.stroke()}function G(t,e){return[t[0]+e[0],t[1]+e[1]]}function Z(t){return Math.atan2(t[1],t[0])}function J(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function K(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function tt(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function et(t){return Math.sqrt(t[0]**2+t[1]**2)}function nt(t){return[t[0]/et(t),t[1]/et(t)]}function it(t,e){return[t[0]-e[0],t[1]-e[1]]}function st(t,e){return t[e]||0===t[e]?t[e]:{color:"black",radius:30}[e]}function rt(t,e){return t[e]||0===t[e]?t[e]:{color:"black",directed:!1,elev:100}[e]}class ot{#ctx=void 0;#width=void 0;#height=void 0;#stateRef=void 0;#animationManagerRef=void 0;#indexingFlag=!0;constructor(t,e){this.#ctx=e.getContext("2d"),this.#width=e.width,this.#height=e.height,this.#stateRef=t,window.api.receive("nodify-indexing-artifacts-toggle",((t,e)=>{this.#indexingFlag=!this.#indexingFlag,this.render()}))}render(){this.#ctx.fillStyle="white",this.#ctx.rect(0,0,this.#width,this.#height),this.#ctx.fill(),console.log("[GR] Rendering.."),this.#indexingFlag&&this.#renderGrid(),this.#renderNodes(this.#stateRef),this.#animationManagerRef.updateAnimations()}#renderGrid(t=100){for(let e=t;e<this.#width;e+=t)for(let n=t;n<this.#height;n+=t){let t=e.toString()+","+n.toString();X(this.#ctx,[e,n],t)}for(let e=0;e<this.#height;e+=t)Q(this.#ctx,[0,e],[this.#width,e]);for(let e=0;e<this.#width;e+=t)Q(this.#ctx,[e,0],[e,this.#height])}#renderConns(t){for(const[e,n]of Object.entries(t.conns)){let e=st(t.nodes[n.id_src],"pos"),i=st(t.nodes[n.id_dest],"pos"),s=st(t.nodes[n.id_src],"radius"),r=st(t.nodes[n.id_dest],"radius"),o=rt(n,"color"),a=rt(n,"directed"),l=Y(e,i,s,r,rt(n,"elev"));if(a){let t=W(l.lineEnd,l.cpPos);this.#ctx.beginPath(),this.#ctx.fillStyle="black",this.#ctx.lineWidth=4,this.#ctx.beginPath(),this.#ctx.moveTo(t.p1[0],t.p1[1]),this.#ctx.lineTo(t.p2[0],t.p2[1]),this.#ctx.lineTo(t.p3[0],t.p3[1]),this.#ctx.fill()}this.#ctx.beginPath(),this.#ctx.strokeStyle=o,this.#ctx.lineWidth=4,this.#ctx.beginPath(),this.#ctx.moveTo(l.lineStart[0],l.lineStart[1]),this.#ctx.quadraticCurveTo(l.cpPos[0],l.cpPos[1],l.lineEnd[0],l.lineEnd[1]),this.#ctx.stroke()}}#renderNodes(t){for(const[e,n]of Object.entries(t.nodes)){const t=n.getCurrentState();let e=st(t,"pos"),i=st(t,"node_id"),s=st(t,"radius");this.#ctx.beginPath(),this.#ctx.arc(e[0],e[1],s,0,2*Math.PI),this.#ctx.lineWidth=4,this.#ctx.strokeStyle="black",this.#ctx.stroke(),this.#indexingFlag&&(this.#ctx.font="2em Courier New",this.#ctx.textAlign="center",this.#ctx.textBaseline="middle",this.#ctx.lineWidth=2,this.#ctx.fillText(i.toString(),e[0],e[1]-1.5*s),this.#ctx.strokeText(i.toString(),e[0],e[1]-1.5*s))}}_indexingPass(t){for(const[e,n]of Object.entries(t.conns)){let e=rt(n,"conn_id"),i=st(t.nodes[n.id_src],"pos"),s=st(t.nodes[n.id_dest],"pos"),r=st(t.nodes[n.id_src],"radius"),o=st(t.nodes[n.id_dest],"radius"),a=rt(n,"elev"),l=Y(i,s,r,o,a),c=25,h=a>=0?c:-c,d=q(l.lineStart,l.cpPos,l.lineEnd,h);this.#ctx.font="2em Courier New",this.#ctx.textAlign="center",this.#ctx.textBaseline="middle",this.#ctx.lineWidth=2,this.#ctx.fillText(e.toString(),d[0],d[1]),this.#ctx.strokeText(e.toString(),d[0],d[1])}for(const[e,n]of Object.entries(t.nodes)){let t=st(n,"pos"),e=st(n,"node_id"),i=st(n,"radius"),s=25,r=[t[0],t[1]-i-s];this.#ctx.font="2em Courier New",this.#ctx.textAlign="center",this.#ctx.textBaseline="middle",this.#ctx.lineWidth=2,this.#ctx.fillText(e.toString(),r[0],r[1]),this.#ctx.strokeText(e.toString(),r[0],r[1])}}setAnimationManagerRef(t){this.#animationManagerRef=t}}class at{constructor(){return this._events={},null==at.instance&&(at.instance=this),at.instance}on(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)}removeListener(t,e){if(!this._events[t])throw new Error(`Can't remove a listener. Event "${t}" doesn't exits.`);this._events[t]=this._events[t].filter((t=>t!==e))}removeAllListeners(){const t=()=>{},e=e=>e===t;for(const[t,n]of Object.entries(this._events))this._events[t]=this._events[t].filter(e)}emit(t,e){if(!this._events[t])throw new Error(`Can't emit an event. Event "${t}" doesn't exits.`);this._events[t].forEach((t=>{t(e)}))}}const lt=new at;Object.freeze(lt);class ct{#graphRendererRef=void 0;#intervalHandler=void 0;#renderMode="once";#animObjectsList=[];#needsToAwaitAnimation=!1;#animCnt=0;animDoneCb=void 0;constructor(){}updateAnimations(){for(let t of this.#animObjectsList)t.updateAnimations();for(let t of this.#animObjectsList)if(t.isAnimationDone()){const e=e=>e!==t;this.#animObjectsList=this.#animObjectsList.filter(e),this.hasNeedsToAwaitAnimation?console.log("[AM] Waited for animation is done,calling handler.."):console.log("[AM] Non-need-to-wait animation done,calling handler.."),this.animDoneCb(),this.#handleDoneAnimation()}}async pushAndWaitAnimIfNeeded(t){return t.hasAnimation()?(this.#animObjectsList.push(t),this.#animCnt=this.#animObjectsList.length,console.log("[AM] Obj has anim, currentCnt: ",this.#animCnt),"loop"!==this.#renderMode&&this.#renderLoop(),!0===t.getCurrentState().anim.shouldWait?(this.#needsToAwaitAnimation=!0,new Promise(((t,e)=>{this.animDoneCb=()=>t()}))):new Promise(((t,e)=>{this.animDoneCb=()=>t()}))):(this.#renderOnce(),new Promise(((t,e)=>t())))}hasNeedsToAwaitAnimation(){return this.#needsToAwaitAnimation}#handleDoneAnimation(){this.#needsToAwaitAnimation=!1,this.#animCnt-=1,this.#animCnt<=0&&this.#renderOnce(),console.log("[AM] Animation done handled, anims remaining: ",this.#animCnt)}#renderLoop(){this.#intervalHandler||(this.#renderMode="loop",this.#intervalHandler=setInterval((()=>this.#graphRendererRef.render()),16),console.log("[AM] Requested mode: loop"),console.log("[AM] Created handler: ",this.#intervalHandler))}#renderOnce(){clearInterval(this.#intervalHandler),console.log("[AM] Requested mode: once"),console.log("[AM] Deleted handler: ",this.#intervalHandler),this.#intervalHandler=void 0,this.#renderMode="once",this.#graphRendererRef.render()}setGraphRendererRef(t){this.#graphRendererRef=t}}const ht=new class{_CLIObject_=void 0;commandText_=void 0;_cmdHistoryArray_=[];_cmdHistoryArraySize_=0;_cmdHistoryOffset_=0;_cliIntro_="#hekapoo$> ";constructor(t){this._CLIObject_=document.getElementById(t),this._listenersSetup(),this._CLIObject_.innerText=this._cliIntro_,this._setCaret(this._cliIntro_.length,this._CLIObject_)}outputStd(t,e){let n=document.createElement("div"),i=`<span id='cmd-info-text-prep'>${t}</span>`,s=this._sanitize(e).replace(/[0-9]+/g,(t=>`<span id='cmd-text-number'>${t}</span>`));n.id="cmd-info-text",n.innerHTML=i+s,document.getElementById("cmd-prepender").appendChild(n)}outputErr(t,e){let n=document.createElement("div"),i=`<span id='cmd-err-text-prep'>${t}</span>`,s=this._sanitize(e).replace(/[0-9]+/g,(t=>`<span id='cmd-text-number'>${t}</span>`));n.id="cmd-err-text",n.innerHTML=i+s,document.getElementById("cmd-prepender").appendChild(n)}outputGiven(t){let e=document.createElement("div"),n=`<span id='cmd-err-info-prep'>${this._cliIntro_}</span>`;e.id="cmd-info-text",e.innerHTML=n+this._sanitize(t),document.getElementById("cmd-prepender").appendChild(e)}_listenersSetup(){this._CLIObject_.addEventListener("paste",(t=>this._pasteListener(t))),this._CLIObject_.addEventListener("keydown",(t=>this._keyDownListener(t))),this._CLIObject_.addEventListener("keyup",(t=>this._keyUpListener(t))),this._CLIObject_.addEventListener("input",(t=>this._inputListener())),this._CLIObject_.addEventListener("focus",(t=>this._focusListener()))}_pasteListener(t){t.preventDefault();let e=""+t.clipboardData.getData("text/plain").replace(this._cliIntro_,"");document.execCommand("insertText",!1,e)}_keyDownListener(t){this._keepCaretAwayFromCLIIntro(t,this._cliIntro_,this._CLIObject_),t||(t=window.event),t.preventDefault&&13===t.which&&(this.commandText_=void 0,this._setEndOfContenteditable(this._CLIObject_),t.preventDefault())}_keyUpListener(t){if(this._keepCaretAwayFromCLIIntro(t,this._cliIntro_,this._CLIObject_),13===t.which&&(void 0===this.commandText_&&(this.commandText_=this._CLIObject_.innerText.replace(this._cliIntro_,"")),this._CLIObject_.innerText=this._cliIntro_,this._setEndOfContenteditable(this._CLIObject_),this._cmdHistoryArray_.push(this.commandText_),this._cmdHistoryOffset_=this._cmdHistoryArray_.length),38===t.which){if(this._cmdHistoryOffset_<=0)return;this._CLIObject_.innerText=this._cliIntro_+this._cmdHistoryArray_[this._cmdHistoryOffset_-1],this._cmdHistoryOffset_-=1,this._setEndOfContenteditable(this._CLIObject_),this._focusListener(this._CLIObject_)}else if(40===t.which){if(this._cmdHistoryOffset_>=this._cmdHistoryArray_.length)return;this._cmdHistoryOffset_+=1,this._CLIObject_.innerText=this._cliIntro_+this._cmdHistoryArray_[this._cmdHistoryOffset_-1],this._setEndOfContenteditable(this._CLIObject_),this._focusListener(this._CLIObject_)}}_inputListener(t){}_focusListener(){}getCLIObject(){return this._CLIObject_}_keepCaretAwayFromCLIIntro(t,e,n){n.innerText.length<e.length&&(n.innerText=e),this._getCaretCharacterOffsetWithin(n)<=e.length&&8===t.which&&t.preventDefault(),this._getCaretCharacterOffsetWithin(n)<e.length&&this._setCaret(e.length,n)}_getCaretCharacterOffsetWithin(t){var e,n=0,i=t.ownerDocument||t.document,s=i.defaultView||i.parentWindow;if(void 0!==s.getSelection){if((e=s.getSelection()).rangeCount>0){var r=s.getSelection().getRangeAt(0),o=r.cloneRange();o.selectNodeContents(t),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length}}else if((e=i.selection)&&"Control"!=e.type){var a=e.createRange(),l=i.body.createTextRange();l.moveToElementText(t),l.setEndPoint("EndToEnd",a),n=l.text.length}return n}_setCaret(t,e){var n=document.createRange(),i=window.getSelection();n.setStart(e.childNodes[0],t),n.collapse(!0),i.removeAllRanges(),i.addRange(n)}_setEndOfContenteditable(t){let e,n;document.createRange&&(e=document.createRange(),e.selectNodeContents(t),e.collapse(!1),n=window.getSelection(),n.removeAllRanges(),n.addRange(e))}_sanitize(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}("cli-textarea"),dt=new class{_canvasObject_=void 0;_canvasCtx_=void 0;_canvasExporter_=void 0;constructor(t){this._canvasObject_=document.getElementById(t),this._canvasCtx_=this._canvasObject_.getContext("2d"),this._canvasExporter_=new M(this._canvasObject_),this._setupCanvas()}_setupCanvas(){this._canvasObject_.width=1500,this._canvasObject_.height=1500}getCanvas(){return this._canvasObject_}getCanvasDetails(){return[this._canvasCtx_?this._canvasCtx_:null,this._canvasObject_.width,this._canvasObject_.height]}}("canvas");function pt(){let t=H.call;F={},H={},H.call=t;let e=window.api.send("nodify-reload-cmds",{});for(let t of e)ut(t,(()=>{F[data.schema.name]=data.schema,H[data.schema.name]=data.logic,document.getElementById("cmd-script").remove()}));console.log("[Index.js] Loaded ",e.length," commands!")}function ut(t,e){let n=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=t,i.id="cmd-script",i.onreadystatechange=e,i.onload=e,n.appendChild(i)}new class{#canvasManager=void 0;#CLIManager=void 0;#graphRenderer=void 0;#stateManager=void 0;#animationManager=void 0;#commandParser=new V;#commandProcessor=new B;constructor(t,e){this.#canvasManager=t,this.#CLIManager=e,this.#stateManager=new $,this.#animationManager=new ct,this.#graphRenderer=new ot(this.#stateManager.getState(),this.#canvasManager.getCanvas()),this.#stateManager.setAnimationManagerRef(this.#animationManager),this.#animationManager.setGraphRendererRef(this.#graphRenderer),this.#graphRenderer.setAnimationManagerRef(this.#animationManager),this.#graphRenderer.render(),this.#CLIManager.getCLIObject().addEventListener("keyup",(t=>this.compute(t)))}async compute(t){if(13!==t.which)return;if(this.#CLIManager.outputGiven(this.#CLIManager.commandText_),this.#animationManager.hasNeedsToAwaitAnimation())return void this.#CLIManager.outputErr("[Animation]","There are awaitable animations ongoing. Command rejected!");let e=this.#CLIManager.commandText_.split("&");try{for(let t of e){let e=this.#commandParser.parse(t),n=await this.#commandProcessor.process(this.#stateManager,e);this.#CLIManager.outputStd("[GraphInfo]",n.msg)}}catch(t){if(console.log(t),t.emptyLine)return this.#CLIManager.outputStd(t.stage,t.msg);this.#CLIManager.outputErr(t.stage,t.msg)}}}(dt,ht),function(t,e){if(void 0===e&&(e={}),x)return{};var n,i,s,r,o,a,l=t;Array.from&&(l=Array.from(l));var c=L(l[0]).parentNode,h=getComputedStyle?getComputedStyle(c):null,d=h?h.flexDirection:null,p=C(e,"sizes")||l.map((function(){return 100/l.length})),u=C(e,"minSize",100),g=Array.isArray(u)?u:l.map((function(){return u})),m=C(e,"maxSize",1/0),f=Array.isArray(m)?m:l.map((function(){return m})),v=C(e,"expandToMin",!1),b=C(e,"gutterSize",10),E=C(e,"gutterAlign","center"),S=C(e,"snapOffset",30),D=C(e,"dragInterval",1),M=C(e,"direction",_),k=C(e,"cursor",M===_?"col-resize":"row-resize"),N=C(e,"gutter",I),R=C(e,"elementStyle",P),j=C(e,"gutterStyle",T);function z(t,e,i,s){var r=R(n,e,i,s);Object.keys(r).forEach((function(e){t.style[e]=r[e]}))}function $(){return a.map((function(t){return t.size}))}function F(t){return"touches"in t?t.touches[0][i]:t[i]}function U(t){var e=a[this.a],n=a[this.b],i=e.size+n.size;e.size=t/this.size*i,n.size=i-t/this.size*i,z(e.element,e.size,this._b,e.i),z(n.element,n.size,this._c,n.i)}function V(t){var n,i=a[this.a],s=a[this.b];this.dragging&&(n=F(t)-this.start+(this._b-this.dragOffset),D>1&&(n=Math.round(n/D)*D),n<=i.minSize+S+this._b?n=i.minSize+this._b:n>=this.size-(s.minSize+S+this._c)&&(n=this.size-(s.minSize+this._c)),n>=i.maxSize-S+this._b?n=i.maxSize+this._b:n<=this.size-(s.maxSize-S+this._c)&&(n=this.size-(s.maxSize+this._c)),U.call(this,n),C(e,"onDrag",A)($()))}function H(){var t=a[this.a].element,e=a[this.b].element,i=t.getBoundingClientRect(),o=e.getBoundingClientRect();this.size=i[n]+o[n]+this._b+this._c,this.start=i[s],this.end=i[r]}function B(t){var e=function(t){if(!getComputedStyle)return null;var e=getComputedStyle(t);if(!e)return null;var n=t[o];return 0===n?null:n-=M===_?parseFloat(e.paddingLeft)+parseFloat(e.paddingRight):parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)}(c);if(null===e)return t;if(g.reduce((function(t,e){return t+e}),0)>e)return t;var n=0,i=[],s=t.map((function(s,r){var o=e*s/100,a=O(b,0===r,r===t.length-1,E),l=g[r]+a;return o<l?(n+=l-o,i.push(0),l):(i.push(o-l),o)}));return 0===n?t:s.map((function(t,s){var r=t;if(n>0&&i[s]-n>0){var o=Math.min(n,i[s]-n);n-=o,r=t-o}return r/e*100}))}function W(){var t=this,n=a[t.a].element,i=a[t.b].element;t.dragging&&C(e,"onDragEnd",A)($()),t.dragging=!1,y.removeEventListener("mouseup",t.stop),y.removeEventListener("touchend",t.stop),y.removeEventListener("touchcancel",t.stop),y.removeEventListener("mousemove",t.move),y.removeEventListener("touchmove",t.move),t.stop=null,t.move=null,n.removeEventListener("selectstart",A),n.removeEventListener("dragstart",A),i.removeEventListener("selectstart",A),i.removeEventListener("dragstart",A),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",i.style.userSelect="",i.style.webkitUserSelect="",i.style.MozUserSelect="",i.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor="",w.body.style.cursor=""}function Y(t){if(!("button"in t)||0===t.button){var n=this,i=a[n.a].element,s=a[n.b].element;n.dragging||C(e,"onDragStart",A)($()),t.preventDefault(),n.dragging=!0,n.move=V.bind(n),n.stop=W.bind(n),y.addEventListener("mouseup",n.stop),y.addEventListener("touchend",n.stop),y.addEventListener("touchcancel",n.stop),y.addEventListener("mousemove",n.move),y.addEventListener("touchmove",n.move),i.addEventListener("selectstart",A),i.addEventListener("dragstart",A),s.addEventListener("selectstart",A),s.addEventListener("dragstart",A),i.style.userSelect="none",i.style.webkitUserSelect="none",i.style.MozUserSelect="none",i.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",n.gutter.style.cursor=k,n.parent.style.cursor=k,w.body.style.cursor=k,H.call(n),n.dragOffset=F(t)-n.end}}M===_?(n="width",i="clientX",s="left",r="right",o="clientWidth"):"vertical"===M&&(n="height",i="clientY",s="top",r="bottom",o="clientHeight"),p=B(p);var q=[];function X(t){var e=t.i===q.length,n=e?q[t.i-1]:q[t.i];H.call(n);var i=e?n.size-t.minSize-n._c:t.minSize+n._b;U.call(n,i)}(a=l.map((function(t,e){var i,s={element:L(t),size:p[e],minSize:g[e],maxSize:f[e],i:e};if(e>0&&((i={a:e-1,b:e,dragging:!1,direction:M,parent:c})._b=O(b,e-1==0,!1,E),i._c=O(b,!1,e===l.length-1,E),"row-reverse"===d||"column-reverse"===d)){var r=i.a;i.a=i.b,i.b=r}if(e>0){var o=N(e,M,s.element);!function(t,e,i){var s=j(n,e,i);Object.keys(s).forEach((function(e){t.style[e]=s[e]}))}(o,b,e),i._a=Y.bind(i),o.addEventListener("mousedown",i._a),o.addEventListener("touchstart",i._a),c.insertBefore(o,s.element),i.gutter=o}return z(s.element,s.size,O(b,0===e,e===l.length-1,E),e),e>0&&q.push(i),s}))).forEach((function(t){var e=t.element.getBoundingClientRect()[n];e<t.minSize&&(v?X(t):t.minSize=e)}))}(["#left-side","#right-side"],{sizes:[65,35]}),new class{constructor(t={}){const e={content:t.viewport.children[0],direction:"all",pointerMode:"all",scrollMode:void 0,bounce:!0,bounceForce:.1,friction:.05,textSelection:!1,inputsFocus:!0,emulateScroll:!1,preventDefaultOnEmulateScroll:!1,preventPointerMoveDefault:!0,lockScrollOnDragDirection:!1,pointerDownPreventDefault:!0,dragDirectionTolerance:40,onPointerDown(){},onPointerUp(){},onPointerMove(){},onClick(){},onUpdate(){},onWheel(){},shouldScroll:()=>!0};if(this.props={...e,...t},!(this.props.viewport&&this.props.viewport instanceof Element))return void console.error('ScrollBooster init error: "viewport" config property must be present and must be Element');if(!this.props.content)return void console.error("ScrollBooster init error: Viewport does not have any content");this.isDragging=!1,this.isTargetScroll=!1,this.isScrolling=!1,this.isRunning=!1;const n={x:0,y:0};this.position={...n},this.velocity={...n},this.dragStartPosition={...n},this.dragOffset={...n},this.clientOffset={...n},this.dragPosition={...n},this.targetPosition={...n},this.scrollOffset={...n},this.rafID=null,this.events={},this.updateMetrics(),this.handleEvents()}updateOptions(t={}){this.props={...this.props,...t},this.props.onUpdate(this.getState()),this.startAnimationLoop()}updateMetrics(){var t;this.viewport={width:this.props.viewport.clientWidth,height:this.props.viewport.clientHeight},this.content={width:(t=this.props.content,Math.max(t.offsetWidth,t.scrollWidth)),height:D(this.props.content)},this.edgeX={from:Math.min(-this.content.width+this.viewport.width,0),to:0},this.edgeY={from:Math.min(-this.content.height+this.viewport.height,0),to:0},this.props.onUpdate(this.getState()),this.startAnimationLoop()}startAnimationLoop(){this.isRunning=!0,cancelAnimationFrame(this.rafID),this.rafID=requestAnimationFrame((()=>this.animate()))}animate(){if(!this.isRunning)return;this.updateScrollPosition(),this.isMoving()||(this.isRunning=!1,this.isTargetScroll=!1);const t=this.getState();this.setContentPosition(t),this.props.onUpdate(t),this.rafID=requestAnimationFrame((()=>this.animate()))}updateScrollPosition(){this.applyEdgeForce(),this.applyDragForce(),this.applyScrollForce(),this.applyTargetForce();const t=1-this.props.friction;this.velocity.x*=t,this.velocity.y*=t,"vertical"!==this.props.direction&&(this.position.x+=this.velocity.x),"horizontal"!==this.props.direction&&(this.position.y+=this.velocity.y),this.props.bounce&&!this.isScrolling||this.isTargetScroll||(this.position.x=Math.max(Math.min(this.position.x,this.edgeX.to),this.edgeX.from),this.position.y=Math.max(Math.min(this.position.y,this.edgeY.to),this.edgeY.from))}applyForce(t){this.velocity.x+=t.x,this.velocity.y+=t.y}applyEdgeForce(){if(!this.props.bounce||this.isDragging)return;const t=this.position.x<this.edgeX.from,e=this.position.x>this.edgeX.to,n=this.position.y<this.edgeY.from,i=this.position.y>this.edgeY.to,s=t||e,r=n||i;if(!s&&!r)return;const o=t?this.edgeX.from:this.edgeX.to,a=n?this.edgeY.from:this.edgeY.to,l=o-this.position.x,c=a-this.position.y,h={x:l*this.props.bounceForce,y:c*this.props.bounceForce},d=this.position.x+(this.velocity.x+h.x)/this.props.friction,p=this.position.y+(this.velocity.y+h.y)/this.props.friction;(t&&d>=this.edgeX.from||e&&d<=this.edgeX.to)&&(h.x=l*this.props.bounceForce-this.velocity.x),(n&&p>=this.edgeY.from||i&&p<=this.edgeY.to)&&(h.y=c*this.props.bounceForce-this.velocity.y),this.applyForce({x:s?h.x:0,y:r?h.y:0})}applyDragForce(){if(!this.isDragging)return;const t=this.dragPosition.x-this.position.x,e=this.dragPosition.y-this.position.y;this.applyForce({x:t-this.velocity.x,y:e-this.velocity.y})}applyScrollForce(){this.isScrolling&&(this.applyForce({x:this.scrollOffset.x-this.velocity.x,y:this.scrollOffset.y-this.velocity.y}),this.scrollOffset.x=0,this.scrollOffset.y=0)}applyTargetForce(){this.isTargetScroll&&this.applyForce({x:.08*(this.targetPosition.x-this.position.x)-this.velocity.x,y:.08*(this.targetPosition.y-this.position.y)-this.velocity.y})}isMoving(){return this.isDragging||this.isScrolling||Math.abs(this.velocity.x)>=.01||Math.abs(this.velocity.y)>=.01}scrollTo(t={}){this.isTargetScroll=!0,this.targetPosition.x=-t.x||0,this.targetPosition.y=-t.y||0,this.startAnimationLoop()}setPosition(t={}){this.velocity.x=0,this.velocity.y=0,this.position.x=-t.x||0,this.position.y=-t.y||0,this.startAnimationLoop()}getState(){return{isMoving:this.isMoving(),isDragging:!(!this.dragOffset.x&&!this.dragOffset.y),position:{x:-this.position.x,y:-this.position.y},dragOffset:this.dragOffset,dragAngle:this.getDragAngle(this.clientOffset.x,this.clientOffset.y),borderCollision:{left:this.position.x>=this.edgeX.to,right:this.position.x<=this.edgeX.from,top:this.position.y>=this.edgeY.to,bottom:this.position.y<=this.edgeY.from}}}getDragAngle(t,e){return Math.round(Math.atan2(t,e)*(180/Math.PI))}getDragDirection(t,e){return Math.abs(90-Math.abs(t))<=90-e?"horizontal":"vertical"}setContentPosition(t){"transform"===this.props.scrollMode&&(this.props.content.style.transform=`translate(${-t.position.x}px, ${-t.position.y}px)`),"native"===this.props.scrollMode&&(this.props.viewport.scrollTop=t.position.y,this.props.viewport.scrollLeft=t.position.x)}handleEvents(){const t={x:0,y:0},e={x:0,y:0};let n=null,i=null,s=!1;const r=i=>{if(!this.isDragging)return;const r=s?i.touches[0]:i,{pageX:o,pageY:a,clientX:l,clientY:c}=r;this.dragOffset.x=o-t.x,this.dragOffset.y=a-t.y,this.clientOffset.x=l-e.x,this.clientOffset.y=c-e.y,(Math.abs(this.clientOffset.x)>5&&!n||Math.abs(this.clientOffset.y)>5&&!n)&&(n=this.getDragDirection(this.getDragAngle(this.clientOffset.x,this.clientOffset.y),this.props.dragDirectionTolerance)),this.props.lockScrollOnDragDirection&&"all"!==this.props.lockScrollOnDragDirection?n===this.props.lockScrollOnDragDirection&&s?(this.dragPosition.x=this.dragStartPosition.x+this.dragOffset.x,this.dragPosition.y=this.dragStartPosition.y+this.dragOffset.y):s?(this.dragPosition.x=this.dragStartPosition.x,this.dragPosition.y=this.dragStartPosition.y):(this.dragPosition.x=this.dragStartPosition.x+this.dragOffset.x,this.dragPosition.y=this.dragStartPosition.y+this.dragOffset.y):(this.dragPosition.x=this.dragStartPosition.x+this.dragOffset.x,this.dragPosition.y=this.dragStartPosition.y+this.dragOffset.y)};this.events.pointerdown=n=>{s=!(!n.touches||!n.touches[0]),this.props.onPointerDown(this.getState(),n,s);const i=s?n.touches[0]:n,{pageX:o,pageY:a,clientX:l,clientY:c}=i,{viewport:h}=this.props,d=h.getBoundingClientRect();if(!(l-d.left>=h.clientLeft+h.clientWidth)&&!(c-d.top>=h.clientTop+h.clientHeight)&&this.props.shouldScroll(this.getState(),n)&&2!==n.button&&("mouse"!==this.props.pointerMode||!s)&&("touch"!==this.props.pointerMode||s)&&!(this.props.inputsFocus&&["input","textarea","button","select","label"].indexOf(n.target.nodeName.toLowerCase())>-1)){if(this.props.textSelection){if(((t,e,n)=>{const i=t.childNodes,s=document.createRange();for(let t=0;t<i.length;t++){const r=i[t];if(3!==r.nodeType)continue;s.selectNodeContents(r);const o=s.getBoundingClientRect();if(e>=o.left&&n>=o.top&&e<=o.right&&n<=o.bottom)return r}return!1})(n.target,l,c))return;(()=>{const t=window.getSelection?window.getSelection():document.selection;t&&(t.removeAllRanges?t.removeAllRanges():t.empty&&t.empty())})()}this.isDragging=!0,t.x=o,t.y=a,e.x=l,e.y=c,this.dragStartPosition.x=this.position.x,this.dragStartPosition.y=this.position.y,r(n),this.startAnimationLoop(),!s&&this.props.pointerDownPreventDefault&&n.preventDefault()}},this.events.pointermove=t=>{!t.cancelable||"all"!==this.props.lockScrollOnDragDirection&&this.props.lockScrollOnDragDirection!==n||t.preventDefault(),r(t),this.props.onPointerMove(this.getState(),t,s)},this.events.pointerup=t=>{this.isDragging=!1,n=null,this.props.onPointerUp(this.getState(),t,s)},this.events.wheel=t=>{const e=this.getState();this.props.emulateScroll&&(this.velocity.x=0,this.velocity.y=0,this.isScrolling=!0,this.scrollOffset.x=-t.deltaX,this.scrollOffset.y=-t.deltaY,this.props.onWheel(e,t),this.startAnimationLoop(),clearTimeout(i),i=setTimeout((()=>this.isScrolling=!1),80),this.props.preventDefaultOnEmulateScroll&&this.getDragDirection(this.getDragAngle(-t.deltaX,-t.deltaY),this.props.dragDirectionTolerance)===this.props.preventDefaultOnEmulateScroll&&t.preventDefault())},this.events.scroll=()=>{const{scrollLeft:t,scrollTop:e}=this.props.viewport;Math.abs(this.position.x+t)>3&&(this.position.x=-t,this.velocity.x=0),Math.abs(this.position.y+e)>3&&(this.position.y=-e,this.velocity.y=0)},this.events.click=t=>{const e=this.getState(),n="vertical"!==this.props.direction?e.dragOffset.x:0,i="horizontal"!==this.props.direction?e.dragOffset.y:0;Math.max(Math.abs(n),Math.abs(i))>5&&(t.preventDefault(),t.stopPropagation()),this.props.onClick(e,t,s)},this.events.contentLoad=()=>this.updateMetrics(),this.events.resize=()=>this.updateMetrics(),this.props.viewport.addEventListener("mousedown",this.events.pointerdown),this.props.viewport.addEventListener("touchstart",this.events.pointerdown,{passive:!1}),this.props.viewport.addEventListener("click",this.events.click),this.props.viewport.addEventListener("wheel",this.events.wheel,{passive:!1}),this.props.viewport.addEventListener("scroll",this.events.scroll),this.props.content.addEventListener("load",this.events.contentLoad,!0),window.addEventListener("mousemove",this.events.pointermove),window.addEventListener("touchmove",this.events.pointermove,{passive:!1}),window.addEventListener("mouseup",this.events.pointerup),window.addEventListener("touchend",this.events.pointerup),window.addEventListener("resize",this.events.resize)}destroy(){this.props.viewport.removeEventListener("mousedown",this.events.pointerdown),this.props.viewport.removeEventListener("touchstart",this.events.pointerdown),this.props.viewport.removeEventListener("click",this.events.click),this.props.viewport.removeEventListener("wheel",this.events.wheel),this.props.viewport.removeEventListener("scroll",this.events.scroll),this.props.content.removeEventListener("load",this.events.contentLoad),window.removeEventListener("mousemove",this.events.pointermove),window.removeEventListener("touchmove",this.events.pointermove),window.removeEventListener("mouseup",this.events.pointerup),window.removeEventListener("touchend",this.events.pointerup),window.removeEventListener("resize",this.events.resize)}}({viewport:document.querySelector("#canvas-cont"),scrollMode:"native"}),new(b())("[data-tabs-left]"),new(b())("[data-tabs-right]"),window.api.receive("nodify-reload-cmds-short",((t,e)=>pt())),pt()})()})();